# permission_scanner.py
"""
ShoshoGuardโข - ูุงุฐูุฉ ูุดู ุงูุตูุงุญูุงุช ุงููุถูููุฉ ๐๐

ูุฐู ุงููุญุฏุฉ ุชุฑุงูุจ ูู ุชุทุจูู ูุทูุจ ุตูุงุญูุงุช ุฒุงูุฏุฉ ูุฃูู ูุฌูุฒ ูุงูููุงุจ ุฏุงุชุง!
ุฃู ุชุทุจูู ูุทูุจ ูุงููุฑุง ููู ูุนุจุฉ "ุชูู ุชุงู ุชู"โฆ ูุฑุณูู ูุจุงุดุฑุฉ ูุตุงูุฉ ุงููุถูุญุฉ ุงููุจุฑู.

- ุฅุนุฏุงุฏ ุดูุดู ูุณุงุฑุฉุ ุจุฑุนุงูุฉ ุงูุณูุญูุงุฉ ุงูุตุงุฑูุฎูุฉ ๐ข๐ฅ
"""

import json

# ูุงุฆูุฉ ุงูุตูุงุญูุงุช ุงููุดุจููุฉ (ููุฏุฑ ููุณุนูุง ูุงุญููุง ูู ููู ุฎุงุฑุฌู ุฃู API)
SUSPICIOUS_PERMISSIONS = {
    "camera": "ููุด ุชุจุบู ุชุตูุฑ ูุฌููุ",
    "microphone": "ุญุงุจุฉ ุชุณูุนูู ุฃุบูู ูู ุงูุฏุดุ",
    "contacts": "ุนุงูุฒ ุฃุตุฏูุงุฆู ูุตูุฑูุง ุฃุตุฏูุงุกูุ",
    "location": "ุจุชุญุจ ุชุชุจุนูู ุญุชู ูู ุงูุญูุงูุ",
    "sms": "ุชูุชุจ ูู ุฑุณุงูู ุญุจุ",
    "bluetooth": "ุชุฑุณู ุฏุงุชุง ูุฃูุฑุจ ุซูุงุฌุฉ ุฐููุฉุ",
    "calendar": "ุจุชุฎุทุท ูุนูุฏ ูููุงุฏู ูู ูุฑุงูุ",
    "call_log": "ุชุจู ุชุชุฃูุฏ ุฅูู ููููู ุฃุญุฏุ",
    "background_location": "ุชุฑุงูุจูู ูุฃูุง ูุงููุ",
    "activity_recognition": "ุชุญุณุจ ุฎุทูุงุชู ูุฃุญูุงููุ"
}

def scan_permissions(app_name, app_permissions):
    """
    ููุญุต ุตูุงุญูุงุช ุงูุชุทุจููุ ูููุดู ุฃู ุตูุงุญูุฉ ูุดุจููุฉ ููุนูู ุนูููุง ุจุณุฎุฑูุฉ.
    :param app_name: ุงุณู ุงูุชุทุจูู
    :param app_permissions: ูุงุฆูุฉ ุงูุตูุงุญูุงุช ุงููุทููุจุฉ
    :return: ุชูุฑูุฑ ูุตู ูุถุญู ุนู ุงูุตูุงุญูุงุช ุงููุดุจููุฉ
    """
    found = []
    for p in app_permissions:
        if p in SUSPICIOUS_PERMISSIONS:
            found.append((p, SUSPICIOUS_PERMISSIONS[p]))

    if not found:
        return f"โ {app_name}: ูุง ุชูุฌุฏ ุตูุงุญูุงุช ูุดุจููุฉโฆ ุงูุชุทุจูู ูููุช ุญุงููุงู!"
    else:
        report = f"๐จ {app_name}: ุชู ุงูุชุดุงู ุตูุงุญูุงุช ูุดุจููุฉ:\n"
        for p, comment in found:
            report += f"  - {p} โ {comment}\n"
        report += "โก๏ธ ูู ุตูุงุญูุฉ ููู ูุนูุงูุง ุงูุชุทุจูู ูููุฑ ูุตูุฑ ุฌูุฌู ูุตุบูุฑ!\n"
        return report

if __name__ == "__main__":
    # ูุซุงู ุณุงุฎุฑ: ุชุทุจูู ูุตุจุงุญ ูุทูุจ ูู ุตูุงุญูุงุช ุงูุฏููุง
    apps = [
        {
            "name": "ุงููุตุจุงุญ ุงููููู",
            "permissions": ["internet", "camera", "location", "bluetooth"]
        },
        {
            "name": "ุขูุฉ ุญุงุณุจุฉ ุนุจูุฑูุฉ",
            "permissions": ["internet", "vibration"]
        },
        {
            "name": "ุชุทุจูู ุณูุญูุงุฉ ูุงุฏุฆุฉ",
            "permissions": []
        }
    ]
    for app in apps:
        print(scan_permissions(app["name"], app["permissions"]))
        print("-" * 50)
